# TCP란,

> 💡 TCP(Transmission Control Protocol)란, 전송 제어 프로토콜로 두 개의 호스트를 연결하고 데이터 스트림을 교환하게 해주는 중요한 네트워크

<img src="https://user-images.githubusercontent.com/45252618/197216440-13fb8cee-1ffa-4000-bc28-4b44d555ae30.png">

## 기능

- 높은 신뢰성
- 호스트 안에서의 프로세스 식별을 통한 데이터 배달
- 신뢰적이고 순차적인 데이터 전달 → 데이터와 패킷이 보내진 순서대로 전달하는 것 보장!!
    - TCP 헤더에 순서번호 필드가 있음
- 흐름제어, 혼잡제어, 오류제어
    - 흐름제어
        - 데이터를 송신하는 곳과 수신하는 곳의 데이터 처리 속도를 조절하여 수신자의 버퍼 오버플로우를 방지하는 것
        - 송신하는 곳에서 감당이 안되게 많은 데이터를 빠르게 보내 수신하는 곳에서 문제가 일어나는 것을 막음
    - 혼잡제어
        - 네트워크 내의 패킷 수가 넘치게 증가하지 않도록 방지하는 것
        - 정보의 소통량이 과다하면 패킷을 조금만 전송하여 혼잡 붕괴 현상이 일어나는 것을 막는다.
- 양방향 연결 (Full Duplex Connection)형 서비스 제공
- UDP보다 느림
- 스트림 위주의 전달 (패킷 단위)
- 상대적으로 큰 헤더 사이즈
    - TCP 프로토콜의 헤더는 기본적으로 20Byte에서 60Byte까지 사용할 수 있는데, 선택적으로 40Byte를 더 추가할 수 있으므로 최대 100Byte까지 크기를 확장할 수 있음.

### cf) TCP 송수신 버퍼

- 송신 버퍼 : 송신 프로세스로부터 생산된 데이터를 받아 수신측에 전송할 데이터를 보관하는 공간
- 수신 버퍼 : 송신측으로부터 전송받은 데이터를 받아 보관하며, 수신 프로세스를 통해 데이터가 소비되는 공간

## 흐름제어

> 💡 네트워크 내의 원활한 흐름을 위해 송수신 측 사이에 전송되는 패킷의 양이나 속도를 규제하는 기능

<img src="https://user-images.githubusercontent.com/45252618/197227214-554e710f-ce64-4e14-8698-46d1c4775d68.jpg">

- 데이터를 송신하는 곳과 수신하는 곳의 데이터 처리 속도를 조절하여 수신자의 버퍼 오버플로우를 방지한다.
- 송신하는 곳에서 감당이 안되게 많은 데이터를 빠르게 보내 수신하는 곳에서 문제가 일어나는 것을 막는다.
- 윈도우 크기로 송신 측의 데이터 전송량을 조절한다.

### Stop-and-Wait

- 수신 측의 확인 신호(ACK)를 받은 후에 다음 패킷을 전송하는 방식
- 한 번에 하나의 패킷만을 전송할 수 있다.

### Sliding Window

- 수신 측의 확인 신호를 받지 않더라도 미리 정해진 패킷의 수만큼 연속적으로 전송하는 방식
    - 윈도우 크기를 참고해서 데이터 흐름을 제어하는 방식
- 한 번에 여러 개의 패킷을 전송할 수 있어 전송 효율이 좋다.
- 송신 측은 수신 측으로부터 확인 신호(ACK) 없이도 보낼 수 있는 패킷의 최대치를 미리 약속받는데, 이 패킷의 최대치가 윈도우 크기를 의미한다.
- 윈도우 크기는 상황에 따라 변한다.
    - 수신 측으로부터 이전에 송신한 패킷에 대한 긍정 수신 응답(ACK)이 전달된 경우 윈도우 크기 증가
    - 수신 측으로부터 이전에 송신한 패킷에 대한 부정 수신 응답(NAK)이 전달된 경우 윈도우 크기 감소

## 혼잡제어

<aside>
💡 네트워크 내의 패킷 수를 조절하여 네트워크의 오버플로를 방지하는 기능

</aside>

- 네트워크 내의 패킷 수가 넘치게 증가하지 않도록 방지하는 것
- 정보의 소통량이 과다하면 패킷을 조금만 전송하여 혼잡 붕괴 현상이 일어나는 것을 막는다.

### Slow Start

- 윈도우의 크기를 1, 2, 4, 8, … 과 같이 2배씩 지수적으로 증가시켜 초기에는 느리지만 갈수록 빨라진다.
- 전송 데이터의 크기가 임계 값에 도달하면 혼잡 회피 단계로 넘어간다.

### Congestion Avoidance

- Slow Start의 지수적 증가가 임계 값에 도달하면 혼잡으로 간주하고 회피를 위해 윈도우의 크기를 1씩 선형적으로 증가시켜 혼잡을 예방하는 방식

## 오류제어

<aside>
💡 데터가 유실되거나 잘못된 데이터가 수신되었을 경우 대처

</aside>

- TCP는 통신 중에 오류가 발생하면 해당 데이터를 재전송한다.
- 재전송 기반 오류 제어 ARQ (Automatic Repeat Request)를 사용한다.

### Stop-and-Wait

- ACK를 받고나서 다음 데이터를 보내는 방식
- 일정 시간이 지나 timeout이 발생하면 이전 데이터를 재전송한다.

### Go Back N

- 연속으로 데이터를 보내다가 오류가 발생한 지점부터 재전송하는 방식
- 성공적으로 전송된 데이터까지 재전송하기 때문에 비효율적인 면이 있다.

### Selective Repeat

- 오류가 발생한 데이터만 재전송하는 방식
- 버퍼의 데이터가 순차적이지 않다.
- 정렬의 과정이 추가로 필요하고 별도의 버퍼가 필요하다.

참고자료 : 네프 교수님 자료, 정보처리기사 자료